/* style.css */

/* =========================================== */
/* === Базовые стили и переменные ========= */
/* =========================================== */
:root {
    /* Telegram Theme Variables (Fallbacks provided) */
    --tg-theme-bg-color: #f0f0f5; /* iOS default background */
    --tg-theme-text-color: #000000;
    --tg-theme-hint-color: #8e8e93; /* iOS Grey */
    --tg-theme-link-color: #ff3b30; /* Flo Pink/Red (Adjusted to match video better) */
    --tg-theme-button-color: #ff3b30; /* Flo Pink/Red */
    --tg-theme-button-text-color: #ffffff;
    --tg-theme-secondary-bg-color: #ffffff; /* White for cards etc. */

    /* Flo Specific Colors (Eyedropped/Approximated from Video) */
    --flo-pink-primary: #ff3b30; /* Main action pink/red */
    --flo-pink-period: #ff8fa3; /* Lighter pink for logged periods */
    --flo-pink-period-bg: #ffeaef; /* Very light bg for predicted period */
    --flo-pink-period-border: #ffc3ce; /* Dashed border for predicted period */
    --flo-teal-bg-wave: #c0fdfd; /* Light teal background for top section */
    --flo-teal-fertile: #4cc6cf; /* Teal for fertile days */
    --flo-teal-fertile-light-bg: #e1f7f8; /* Light teal bg for fertile days */
    --flo-teal-button: #4cc6cf; /* Teal button color (e.g., add symptoms in calendar) */
    --flo-grey-text-primary: #1c1c1e; /* Near black text */
    --flo-grey-text-secondary: #636366; /* Medium grey text */
    --flo-grey-text-tertiary: #8e8e93; /* Light grey text */
    --flo-grey-background: #f2f2f7; /* Main background grey */
    --flo-grey-card-bg: #ffffff; /* Card background */
    --flo-grey-border: #e5e5ea; /* Light border color */
    --flo-grey-dot: #e0e0e0; /* Inactive dots/placeholders */
    --flo-green-check: #34c759; /* iOS Green for "Норма" */
    --flo-orange-highlight: #ff9f0a; /* Orange for fertility card bg */
    --flo-purple-light-bg: #f4eaff; /* Light purple for some cards */
    --flo-purple-icon-bg: #e0c6ff;
    --flo-purple-text: #8e4dff;
    --flo-blue-light-bg: #eaf5ff; /* Light blue for some cards */
    --flo-blue-text: #007aff;
    --flo-ovulation-dot: #ff9f0a; /* Orange dot for ovulation day */
    --flo-black-outline: #000000; /* Outline for today in calendar */

    --header-height: 50px; /* Adjusted based on visual */
    --bottom-nav-height: 50px; /* Standard height */
    --card-border-radius: 12px;
    --button-border-radius: 25px;
    --tag-border-radius: 18px;
}

/* --- Base & Reset --- */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; /* Match iOS */
    background-color: var(--flo-grey-background);
    color: var(--flo-grey-text-primary);
    overscroll-behavior: none;
    font-size: 17px; /* Default iOS size */
    padding-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom));
    line-height: 1.4;
    -webkit-text-size-adjust: none; /* Prevent font scaling */
    overflow-x: hidden; /* Prevent horizontal scroll on body */
    min-height: var(--tg-viewport-stable-height, 100vh);
}

.app { display: flex; flex-direction: column; min-height: 100%; }
.content { flex-grow: 1; overflow-y: auto; overflow-x: hidden; }
.screen { display: none; animation: fadeIn 0.2s ease-in-out; padding-bottom: 16px; /* Space before bottom nav */}
.screen.active { display: block; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* =========================================== */
/* === Header ================================ */
/* =========================================== */
.screen-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 16px; background-color: var(--flo-grey-background);
    position: sticky; top: 0; z-index: 10;
    height: var(--header-height); min-height: var(--header-height);
}
.screen-header.with-border { border-bottom: 0.5px solid var(--flo-grey-border); background-color: var(--tg-theme-secondary-bg-color); }
.screen-header.today-header { background-color: transparent; position: absolute; } /* For Today Screen */

.current-date { /* Centered title */
    font-weight: 600; font-size: 17px; text-align: center;
    position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
    white-space: nowrap; color: var(--flo-grey-text-primary);
}
.screen-header.today-header .current-date { display: none; } /* Hide centered title on today screen */
.header-icons { display: flex; align-items: center; flex-shrink: 0; gap: 16px; }
.icon-button { cursor: pointer; color: var(--tg-theme-link-color); /* Match link color */ width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; }
.icon-button svg { width: 24px; height: 24px; stroke-width: 2; }

.back-button, .close-button {
    cursor: pointer; color: var(--tg-theme-link-color); padding: 5px; margin-left: -8px; /* Pull left */
    width: 34px; height: 34px; display: flex; align-items: center; justify-content: center;
}
.back-button svg, .close-button svg { width: 24px; height: 24px; stroke-width: 2.5; }
.close-button svg { stroke-width: 2.5; }

/* =========================================== */
/* === Общие компоненты ===================== */
/* =========================================== */
.card {
    background-color: var(--tg-theme-secondary-bg-color);
    border-radius: var(--card-border-radius);
    padding: 14px 16px; /* Consistent padding */
    box-shadow: 0 1px 3px rgba(60, 60, 67, 0.04); /* Subtle shadow */
    margin: 0 16px 10px; /* Spacing */
}
.card:last-child { margin-bottom: 0; }

.section-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 10px; padding: 0 16px;
}
.section-header h2 {
    font-size: 20px; font-weight: 700; /* Bold Title */ margin: 0;
    color: var(--flo-grey-text-primary);
}
.view-all-link {
    font-size: 15px; color: var(--tg-theme-link-color); cursor: pointer; font-weight: 400; /* Regular weight */
    text-decoration: none; display: flex; align-items: center; gap: 2px;
}
.view-all-link span.arrow svg { width: 14px; height: 14px; stroke-width: 2; }
.arrow { color: var(--flo-grey-text-tertiary); }
.arrow svg { width: 16px; height: 16px; stroke-width: 2; }

.info-icon {
    width: 18px; height: 18px; border-radius: 50%; color: var(--flo-grey-text-tertiary);
    display: inline-flex; align-items: center; justify-content: center; cursor: pointer;
}
.info-icon svg { width: 100%; height: 100%; stroke-width: 2; }

/* Utility for horizontal scrolling containers */
.horizontal-scroll { display: flex; overflow-x: auto; padding: 0 16px 10px; gap: 10px; -ms-overflow-style: none; scrollbar-width: none; }
.horizontal-scroll::-webkit-scrollbar { display: none; }
.horizontal-scroll > .card { margin: 0; flex: 0 0 auto; } /* Override card margin within scroll */

/* =========================================== */
/* === Экран "Сегодня" ====================== */
/* =========================================== */
#screen-today { padding-top: 0; padding-bottom: 0; } /* Full height screen */

/* --- Day Navigation Header --- */
.today-header { height: auto; min-height: 0; position: sticky; /* Stick to top under main visual */ top: 0; background-color: var(--flo-teal-bg-wave); padding-top: env(safe-area-inset-top); z-index: 5; /* Below main visual's wave */ }
.day-navigation-strip { display: flex; align-items: center; justify-content: space-between; padding: 6px 0; }
.day-nav-arrow { background: none; border: none; padding: 8px; cursor: pointer; color: var(--flo-grey-text-secondary); }
.day-nav-arrow svg { width: 20px; height: 20px; stroke-width: 2.5; }
.day-nav-items { display: flex; justify-content: center; gap: 5px; overflow: hidden; flex-grow: 1; }
.day-nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 4px 6px; cursor: pointer; text-align: center; border-radius: 18px; /* Oval shape */ width: 44px; height: 44px; }
.day-nav-item .day-letter { font-size: 10px; font-weight: 600; text-transform: uppercase; color: var(--flo-grey-text-secondary); margin-bottom: 2px; }
.day-nav-item .day-num { font-size: 17px; font-weight: 500; line-height: 1; color: var(--flo-grey-text-primary); }
.day-nav-item.current { background-color: var(--tg-theme-secondary-bg-color); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
.day-nav-item.current .day-letter { color: var(--flo-pink-primary); font-weight: 700; }
.day-nav-item.current .day-num { font-weight: 600; }

/* --- Main Visual Area --- */
.main-visual {
    position: relative; text-align: center;
    padding: calc(var(--header-height) + 44px + 20px) 20px 70px; /* Top padding = header + daynav + space */
    background: var(--flo-teal-bg-wave);
    overflow: hidden; margin-bottom: 16px;
}
.wave-background {
    position: absolute; bottom: 0; left: -5%; width: 110%; height: 50px;
    background-color: var(--flo-grey-background);
    border-top-left-radius: 50% 100%; border-top-right-radius: 50% 100%;
    z-index: 1;
}
.cycle-status-primary {
    margin: 0 0 6px; font-size: 28px; font-weight: 700; color: var(--flo-grey-text-primary);
    position: relative; z-index: 2; line-height: 1.2;
}
.cycle-status-primary .days-count { /* Keep number and 'days' together */ display: inline-block; }
.cycle-status-secondary {
    margin: 0 0 20px; font-size: 15px; color: var(--flo-grey-text-secondary);
    position: relative; z-index: 2;
}
.log-period-btn {
    background-color: var(--tg-theme-secondary-bg-color); color: var(--flo-pink-primary); border: none;
    padding: 10px 20px; border-radius: var(--button-border-radius);
    font-size: 15px; font-weight: 600; cursor: pointer; position: relative; z-index: 2;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* --- Daily Cards --- */
.daily-cards-section { margin-bottom: 24px; }
.daily-cards-section .section-header { margin-bottom: 10px; }
.daily-cards-section .section-header h2 { font-size: 17px; font-weight: 600; }
.daily-cards-section .section-header .dynamic-date-label { font-weight: 400; color: var(--flo-grey-text-secondary); }

.daily-card {
    width: 135px; height: 140px;
    display: flex; flex-direction: column; justify-content: space-between; align-items: flex-start;
    padding: 12px; font-size: 14px; line-height: 1.3; position: relative;
    border: 0.5px solid var(--flo-grey-border); box-shadow: none; /* Reset default card shadow */
    overflow: hidden; /* Clip content */
}
.log-symptoms-card { align-items: center; justify-content: center; text-align: center; cursor: pointer; background-color: var(--tg-theme-secondary-bg-color); }
.log-symptoms-card .card-plus-icon {
    width: 40px; height: 40px; background-color: var(--flo-pink-primary); color: white;
    border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;
}
.log-symptoms-card .card-plus-icon svg { width: 24px; height: 24px; stroke-width: 2.5; }
.log-symptoms-card p { font-weight: 500; font-size: 15px; color: var(--flo-grey-text-primary); }

.daily-card .card-title { font-size: 13px; font-weight: 600; color: var(--flo-grey-text-primary); line-height: 1.3; }
.daily-card .card-subtitle { font-size: 13px; font-weight: 400; color: var(--flo-grey-text-secondary); margin-top: auto; }

.fertility-card-today { background-color: var(--flo-orange-highlight); border-color: transparent; }
.fertility-card-today .card-title { color: var(--flo-grey-text-primary); }
.fertility-card-today .card-dots { font-size: 24px; color: var(--flo-grey-text-primary); margin: 8px 0; line-height: 1; }
.fertility-card-today .card-subtitle { color: var(--flo-grey-text-primary); opacity: 0.7; }

.discharge-card { background-color: var(--flo-blue-light-bg); border-color: transparent; }
.discharge-card .card-title { color: var(--flo-blue-text); }
.discharge-card .card-icon-large { flex-grow: 1; display: flex; align-items: center; justify-content: center; }
.discharge-card .discharge-icon { font-size: 36px; /* Placeholder styling */ opacity: 0.5; }
.discharge-card .card-subtitle { color: var(--flo-grey-text-primary); font-weight: 500; text-align: center; width: 100%;}

.possible-symptoms-card-today { background-color: var(--flo-purple-light-bg); border-color: transparent; }
.possible-symptoms-card-today .card-title { color: var(--flo-purple-text); margin-bottom: 8px; }
.possible-symptoms-card-today .symptom-icons-row { display: flex; gap: 8px; margin-top: auto; justify-content: flex-start; }
.possible-symptoms-card-today .s-icon { font-size: 24px; background-color: var(--flo-purple-icon-bg); border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; }

.current-cycle-day-card { background-color: #e4e4e8; border-color: transparent; }
.current-cycle-day-card .card-title { color: var(--flo-grey-text-secondary); font-weight: 500; }
.current-cycle-day-card .card-day-number { font-size: 48px; font-weight: 600; color: var(--flo-grey-text-primary); margin-top: auto; line-height: 1; }

/* --- Сводка циклов --- */
.my-cycles-summary { padding: 0; margin-bottom: 20px; }
.my-cycles-summary .section-header { padding: 0 16px; margin-bottom: 8px; }
.cycle-info-card { padding: 14px 16px; }
.cycle-info-card .info-row { display: flex; align-items: center; justify-content: space-between; }
.cycle-info-card .info-row:first-child { margin-bottom: 6px; }
.cycle-info-card .info-label { font-size: 15px; color: var(--flo-grey-text-secondary); }
.cycle-info-card .info-value { font-size: 15px; font-weight: 600; color: var(--flo-grey-text-primary); }
.cycle-info-card .status-ok { color: var(--flo-green-check); font-size: 13px; font-weight: 500; display: flex; align-items: center; gap: 4px; }
.cycle-info-card .status-ok .check-icon svg { width: 16px; height: 16px; }
/* Add .status-warning if needed later */

/* =========================================== */
/* === Экран "Ввод симптомов" ============== */
/* =========================================== */
#screen-log-symptoms { padding-top: var(--header-height); background-color: var(--tg-theme-secondary-bg-color); }
#screen-log-symptoms .screen-header { position: fixed; width: 100%; top: 0; background-color: var(--tg-theme-secondary-bg-color); }
#screen-log-symptoms .current-date .cycle-day-detail { font-size: 12px; color: var(--flo-grey-text-secondary); display: block; line-height: 1; }
#screen-log-symptoms .next-day-log { color: var(--tg-theme-link-color); }
.log-search-bar { display: flex; align-items: center; background-color: var(--flo-grey-background); margin: 12px 16px; padding: 8px 12px; border-radius: 10px; }
.log-search-bar svg { color: var(--flo-grey-text-tertiary); margin-right: 8px; width: 18px; height: 18px; }
.log-search-bar input { flex-grow: 1; border: none; background: none; font-size: 16px; outline: none; color: var(--flo-grey-text-primary); }
.log-search-bar input::placeholder { color: var(--flo-grey-text-tertiary); }

.quick-log-tags { display: flex; gap: 8px; padding: 0 16px 16px; border-bottom: 0.5px solid var(--flo-grey-border); }
.quick-tag { background-color: var(--flo-grey-background); border: none; border-radius: var(--tag-border-radius); padding: 8px 14px; font-size: 14px; color: var(--flo-grey-text-primary); cursor: pointer; display: flex; align-items: center; gap: 6px; }
.quick-tag .emoji { font-size: 18px; }

.log-categories { padding: 16px 0; }
.log-category { margin-bottom: 24px; }
.log-category:last-child { margin-bottom: 0; }
.log-category-header { display: flex; justify-content: space-between; align-items: center; padding: 0 16px; margin-bottom: 12px; }
.log-category h3 { font-size: 17px; font-weight: 600; margin: 0; color: var(--flo-grey-text-primary); }
.edit-category-btn { background: none; border: none; color: var(--tg-theme-link-color); font-size: 15px; font-weight: 400; cursor: pointer; padding: 0; }

.log-tags-container { display: flex; flex-wrap: wrap; gap: 8px; padding: 0 16px; }
.log-tag {
    background-color: var(--flo-grey-background); border: 1.5px solid transparent; /* For active state */
    border-radius: var(--tag-border-radius); padding: 8px 14px; font-size: 15px;
    color: var(--flo-grey-text-primary); cursor: pointer; display: flex; align-items: center; gap: 6px;
    line-height: 1.3;
}
.log-tag .icon, .log-tag .emoji { font-size: 18px; line-height: 1; /* Adjust icon/emoji size/alignment */ }
.log-tag.active { background-color: var(--flo-pink-period-bg); border-color: var(--flo-pink-period); color: var(--flo-pink-primary); font-weight: 500; }
.log-tag.add-test-btn { background-color: var(--flo-teal-fertile-light-bg); color: var(--flo-teal-fertile); }
.log-tag.add-test-btn .icon { color: var(--flo-teal-fertile); }
.test-note { font-size: 13px; color: var(--flo-grey-text-secondary); padding: 8px 16px 0; margin: 0; }

.water-tracker { display: flex; align-items: center; justify-content: space-between; background-color: var(--flo-grey-background); border-radius: var(--tag-border-radius); padding: 4px; margin: 0 16px; }
.water-btn { background-color: var(--tg-theme-secondary-bg-color); border: none; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; cursor: pointer; color: var(--tg-theme-link-color); box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
.water-btn svg { width: 20px; height: 20px; stroke-width: 2.5; }
.water-amount { font-size: 16px; font-weight: 500; color: var(--flo-grey-text-primary); }
.settings-link { display: block; margin: 12px 16px 0; font-size: 15px; color: var(--tg-theme-link-color); text-decoration: none; display: flex; align-items: center; justify-content: space-between; }
.settings-link svg { width: 16px; height: 16px; color: var(--flo-grey-text-tertiary); }

/* =========================================== */
/* === Экран "Календарь" ==================== */
/* =========================================== */
#screen-calendar-view { padding-top: var(--header-height); background: var(--tg-theme-secondary-bg-color); padding-bottom: 0; /* Panel handles bottom space */ }
#screen-calendar-view .screen-header { background-color: var(--tg-theme-secondary-bg-color); position: fixed; width: 100%; top: 0; z-index: 20; }
#screen-calendar-view .close-button { color: var(--tg-theme-link-color); }

.calendar-nav { display: flex; align-items: center; justify-content: center; flex-grow: 1; }
.calendar-nav .month-year-toggle { display: flex; background-color: var(--flo-grey-background); border-radius: 8px; padding: 2px; }
.calendar-nav .toggle-btn { padding: 4px 14px; font-size: 13px; font-weight: 600; border: none; background-color: transparent; border-radius: 6px; color: var(--flo-grey-text-secondary); cursor: pointer; }
.calendar-nav .toggle-btn.active { background-color: var(--tg-theme-secondary-bg-color); color: var(--flo-grey-text-primary); box-shadow: 0 0.5px 2px rgba(0, 0, 0, 0.1), 0 1px 1px rgba(0,0,0,0.05); }

.calendar-main-area { padding-top: 10px; }

/* --- Month/Year Navigation --- */
.month-navigation, .year-navigation { display: flex; justify-content: space-between; align-items: center; padding: 5px 16px 15px; }
.month-nav-arrow, .year-nav-arrow { background: none; border: none; padding: 5px; cursor: pointer; color: var(--tg-theme-link-color); }
.month-nav-arrow svg, .year-nav-arrow svg { width: 20px; height: 20px; stroke-width: 2.5; }
.month-year-display, .year-display { font-size: 17px; font-weight: 600; text-align: center; flex-grow: 1; }

/* --- Месячный вид --- */
#calendar-month-container {}
.calendar-grid-container { padding: 0 16px; }
.calendar-weekdays { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; margin-bottom: 8px; font-size: 12px; font-weight: 500; color: var(--flo-grey-text-tertiary); }
.calendar-days-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px 4px; /* Row gap slightly larger */}

.calendar-days-grid .day {
    aspect-ratio: 1 / 1; max-height: 48px; /* Slightly larger */
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    position: relative; cursor: pointer; border-radius: 50%;
    background-color: transparent; border: 2px solid transparent; /* Border for today */
}
.day span.day-number { font-size: 17px; line-height: 1; position: relative; z-index: 2; color: var(--flo-grey-text-primary); font-weight: 400; }
.day .day-indicator { position: absolute; bottom: 4px; /* Adjust as needed */ left: 50%; transform: translateX(-50%); display: flex; gap: 2px; z-index: 3; line-height: 0; }
.day .day-indicator span { width: 5px; height: 5px; border-radius: 50%; }
.day .day-indicator .indicator-heart { /* Placeholder for heart - use SVG or background image */ background-color: var(--flo-pink-primary); opacity: 0.6; }
.day .day-indicator .indicator-dot { /* Small grey dot */ background-color: var(--flo-grey-text-tertiary); }
.day.day-period .day-indicator .indicator-heart { background-color: white; opacity: 1;}

/* Day States */
.day.other-month { cursor: default; background-color: transparent !important; border-color: transparent !important; }
.day.other-month span.day-number { color: var(--flo-grey-text-tertiary); opacity: 0.7; }
.day.other-month .day-indicator { display: none !important; }

.day.day-period { background-color: var(--flo-pink-period); border-color: var(--flo-pink-period); }
.day.day-period span.day-number { color: var(--flo-pink-primary); font-weight: 500; }

.day.day-period-predicted { background-color: var(--flo-pink-period-bg); border: 1.5px dashed var(--flo-pink-period-border); }
.day.day-period-predicted span.day-number { color: var(--flo-pink-primary); }

.day.day-fertile-predicted { background-color: var(--flo-teal-fertile-light-bg); border: 1.5px solid var(--flo-teal-fertile); }
.day.day-fertile-predicted span.day-number { color: var(--flo-teal-fertile); }
.day.day-fertile-maybe { border: 1.5px dotted var(--flo-teal-fertile); }
.day.day-fertile-maybe span.day-number { color: var(--flo-teal-fertile); }

.day.day-ovulation-predicted { background-color: var(--flo-teal-fertile-light-bg); border: 1.5px solid var(--flo-teal-fertile); }
.day.day-ovulation-predicted span.day-number { color: var(--flo-teal-fertile); }
.day.day-ovulation-predicted .day-indicator::before { /* Ovulation dot style */
    content: ''; display: block; width: 7px; height: 7px; background-color: var(--flo-ovulation-dot); border-radius: 50%;
    position: absolute; bottom: 0px; left: 50%; transform: translateX(-50%); z-index: 4;
}
.day.day-ovulation-predicted .day-indicator span { display: none; } /* Hide other indicators */

.day.day-today { border-color: var(--flo-black-outline) !important; z-index: 5; }
.day.day-today span.day-number { font-weight: 600; }

/* --- Годовой вид --- */
#calendar-year-container { padding: 10px 16px; }
.year-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px 15px; }
.month-grid-item h3 { font-size: 14px; font-weight: 600; margin: 0 0 8px; text-align: center; }
.mini-month-days { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; background-color: var(--flo-grey-background); padding: 3px; border-radius: 4px; }
.mini-day {
    aspect-ratio: 1 / 1; border-radius: 2px; background-color: var(--tg-theme-secondary-bg-color);
    font-size: 6px; display: flex; align-items: center; justify-content: center; color: var(--flo-grey-text-tertiary);
}
.mini-day.day-period { background-color: var(--flo-pink-period); }
.mini-day.day-fertile-predicted, .mini-day.day-ovulation-predicted { background-color: var(--flo-teal-fertile-light-bg); border: 0.5px solid var(--flo-teal-fertile);}
.mini-day.day-period-predicted { background-color: var(--flo-pink-period-bg); border: 0.5px dashed var(--flo-pink-period-border); }
.mini-day.today { outline: 1px solid var(--flo-black-outline); z-index: 1; }
.mini-day.other-month { background-color: transparent; border: none; }


/* --- Нижняя панель календаря --- */
.calendar-bottom-panel {
    background-color: var(--tg-theme-secondary-bg-color);
    border-top-left-radius: 16px; border-top-right-radius: 16px;
    padding: 8px 0 16px; /* Top padding reduced for handle */
    margin-top: 10px; box-shadow: 0 -3px 10px rgba(0,0,0,0.08);
    position: sticky; bottom: 0; z-index: 15;
    padding-bottom: calc(16px + env(safe-area-inset-bottom)); /* Add safe area padding */
}
.panel-drag-handle { width: 36px; height: 5px; background-color: #d1d1d6; border-radius: 2.5px; margin: 0 auto 10px; }
.calendar-date-info { display: flex; align-items: center; justify-content: space-between; padding: 0 16px; margin-bottom: 16px; }
.calendar-date-info .date-text { font-size: 18px; font-weight: 600; }
.calendar-date-info .close-panel-icon { color: var(--flo-grey-text-tertiary); cursor: pointer; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; background-color: var(--flo-grey-background); border-radius: 50%; }
.close-panel-icon svg { width: 16px; height: 16px; stroke-width: 2.5; }

.symptoms-events-section { padding: 0 16px; }
.symptoms-events-section h3 { font-size: 17px; font-weight: 600; margin: 0 0 12px; }
.symptoms-events-content { display: flex; align-items: flex-start; gap: 15px; } /* Align items to top */
.symptom-item { text-align: center; font-size: 11px; color: var(--flo-grey-text-secondary); line-height: 1.2; flex-shrink: 0; width: 50px; }
.symptom-item .icon { display: block; width: 40px; height: 40px; background: var(--flo-grey-background); border-radius: 50%; margin: 0 auto 4px; display: flex; align-items: center; justify-content: center; font-size: 18px; }
.symptom-item.logged .icon { background: var(--flo-pink-period-bg); } /* Example logged style */
.symptom-item.logged { color: var(--flo-grey-text-primary); font-weight: 500; }

.add-event-btn {
    width: 40px; height: 40px; background-color: var(--flo-teal-button); color: white; border-radius: 50%;
    border: none; font-size: 26px; font-weight: 300; line-height: 38px; text-align: center;
    cursor: pointer; flex-shrink: 0; margin-left: auto; /* Push to the right */
}

/* Reuse daily cards styles within panel */
.daily-cards-section.in-panel { margin-top: 20px; padding-bottom: 0; }
.daily-cards-section.in-panel h2 { font-size: 17px; font-weight: 600; margin-bottom: 10px; padding: 0 16px; }
.daily-cards-section.in-panel .cards-container { padding: 0 16px 0; } /* No bottom padding needed */

/* =========================================== */
/* === Экран "Статьи/Секреты" ============== */
/* =========================================== */
#screen-articles { padding-top: var(--header-height); }
#screen-articles .screen-header { position: fixed; width: 100%; top: 0; z-index: 20; background-color: var(--tg-theme-secondary-bg-color);}
#screen-articles .icon-button { color: var(--flo-grey-text-primary); } /* Black icons */

.articles-section { padding: 16px 0 20px; }
.articles-section h2 { font-size: 22px; font-weight: 700; margin: 0 16px 12px; }
.article-card { border-radius: var(--card-border-radius); overflow: hidden; background: var(--flo-grey-card-bg); box-shadow: 0 2px 8px rgba(0,0,0,0.08); cursor: pointer; width: 160px; position: relative; }
.article-card.large { width: 240px; }
.article-card img { display: block; width: 100%; height: 110px; object-fit: cover; background-color: var(--flo-grey-dot); }
.article-card.large img { height: 160px; }
.article-card .card-text { position: absolute; bottom: 0; left: 0; right: 0; padding: 20px 12px 12px; font-size: 15px; font-weight: 600; color: white; line-height: 1.3; background: linear-gradient(to top, rgba(0,0,0,0.75) 0%, rgba(0,0,0,0) 100%); }
.video-card .play-icon { position: absolute; top: 12px; left: 12px; font-size: 11px; color: white; background-color: rgba(0, 0, 0, 0.5); border-radius: 4px; padding: 2px 6px; display: flex; align-items: center; gap: 4px; font-weight: 500; }
.video-card .play-icon svg { width: 10px; height: 10px; stroke-width: 2; }

/* =========================================== */
/* === Экран "Партнер" ===================== */
/* =========================================== */
#screen-partner { padding-top: var(--header-height); }
#screen-partner .screen-header { position: fixed; width: 100%; top: 0; z-index: 20; background-color: var(--tg-theme-secondary-bg-color);}
.partner-content { padding: 16px; }
.partner-content h2 { font-size: 22px; font-weight: 700; margin-bottom: 10px; }
.partner-content h3 { font-size: 17px; font-weight: 600; margin-top: 24px; margin-bottom: 10px; }
.partner-content p { font-size: 15px; color: var(--flo-grey-text-secondary); line-height: 1.4; margin-bottom: 16px; }
.partner-action-btn {
    width: 100%; padding: 14px; font-size: 17px; font-weight: 600;
    border-radius: var(--card-border-radius); border: none; cursor: pointer;
    background-color: var(--flo-pink-primary); color: white; margin-bottom: 20px;
}
.partner-action-btn.secondary { background-color: var(--flo-grey-background); color: var(--tg-theme-link-color); display: flex; align-items: center; justify-content: center; gap: 8px; }
.partner-action-btn.secondary svg { width: 18px; height: 18px; }

.partner-info-block { margin-bottom: 24px; }
.partner-info-block img { display: block; width: 100%; max-width: 300px; height: auto; border-radius: 8px; margin-bottom: 12px; background-color: var(--flo-grey-dot); border: 1px solid var(--flo-grey-border); }
.partner-info-block h4 { font-size: 16px; font-weight: 600; margin-bottom: 6px; }
.partner-info-block p { font-size: 14px; margin-bottom: 0; }
.support-note { margin-top: 30px; font-size: 14px; }

/* =========================================== */
/* === Экран "Настройки/Меню" ============== */
/* =========================================== */
#screen-settings { padding-top: var(--header-height); }
#screen-settings .screen-header { position: fixed; width: 100%; top: 0; z-index: 20; background-color: var(--tg-theme-secondary-bg-color);}

.profile-info-section { display: flex; align-items: center; padding: 16px; background-color: var(--tg-theme-secondary-bg-color); gap: 12px; margin-bottom: 16px; }
.profile-avatar { position: relative; flex-shrink: 0; }
.profile-avatar img { width: 64px; height: 64px; border-radius: 50%; background-color: var(--flo-grey-dot); display: block; }
.profile-edit-icon { position: absolute; bottom: 0; right: 0; width: 24px; height: 24px; background-color: var(--flo-grey-text-primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid white; }
.profile-edit-icon svg { width: 12px; height: 12px; stroke-width: 2; }
.profile-details { flex-grow: 1; }
.profile-email { display: block; font-size: 15px; color: var(--flo-grey-text-secondary); margin-bottom: 4px; }
.profile-edit-button { background: none; border: none; color: var(--tg-theme-link-color); font-size: 15px; padding: 0; cursor: pointer; }
.profile-premium-badge { background-color: var(--flo-pink-primary); color: white; font-size: 11px; font-weight: 600; padding: 3px 8px; border-radius: 10px; white-space: nowrap; margin-left: auto; align-self: flex-start; }

.premium-family-section { text-align: center; padding: 16px; }
.premium-family-icons { display: flex; justify-content: center; margin-bottom: 12px; }
.premium-family-icons span { width: 32px; height: 32px; border-radius: 50%; background-color: var(--flo-grey-dot); border: 2px solid white; margin-left: -10px; }
.premium-family-icons span:first-child { margin-left: 0; }
.premium-family-section h4 { font-size: 17px; font-weight: 600; margin: 0 0 6px; }
.premium-family-section p { font-size: 14px; color: var(--flo-grey-text-secondary); margin: 0 0 16px; line-height: 1.3; }
.premium-family-section button { background-color: var(--flo-pink-primary); color: white; border: none; padding: 10px 20px; border-radius: var(--button-border-radius); font-size: 15px; font-weight: 600; cursor: pointer; }

.settings-goal { padding: 16px; } /* No background needed */
.settings-goal h3 { margin: 0 0 10px; font-size: 13px; font-weight: 400; color: var(--flo-grey-text-secondary); text-transform: uppercase; }
.goal-buttons { display: flex; gap: 8px; }
.goal-btn { flex-grow: 1; padding: 7px 10px; font-size: 14px; font-weight: 500; border: 1px solid var(--flo-grey-border); border-radius: var(--button-border-radius); background-color: var(--tg-theme-secondary-bg-color); color: var(--flo-grey-text-primary); cursor: pointer; transition: all 0.2s; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.goal-btn.active { background-color: var(--flo-pink-period-bg); border-color: var(--flo-pink-primary); color: var(--flo-pink-primary); font-weight: 600; }

.settings-list { list-style: none; padding: 0; margin: 0 0 16px; background-color: var(--tg-theme-secondary-bg-color); border-top: 0.5px solid var(--flo-grey-border); border-bottom: 0.5px solid var(--flo-grey-border); }
.settings-item { display: flex; align-items: center; padding: 0 16px; cursor: pointer; border-bottom: 0.5px solid var(--flo-grey-border); min-height: 48px; }
.settings-item:last-child { border-bottom: none; }
.settings-icon { margin-right: 16px; width: 28px; height: 28px; text-align: center; color: var(--flo-grey-text-secondary); display: flex; align-items: center; justify-content: center; /* Icons might need specific colors */ }
.settings-icon svg { width: 22px; height: 22px; stroke-width: 2; }
.settings-item-text { flex-grow: 1; font-size: 17px; color: var(--flo-grey-text-primary); }
.settings-item .arrow svg { width: 14px; height: 14px; margin-left: auto; color: var(--flo-grey-text-tertiary); }

/* Specific Icon Colors (Examples) */
#nav-doctor-report .settings-icon { color: #ff9500; } /* Orange */
#nav-charts-reports .settings-icon { color: #34c759; } /* Green */
#nav-cycle-ovulation .settings-icon { color: #5ac8fa; } /* Light Blue */
#nav-app-settings .settings-icon { color: #8e8e93; } /* Grey */
#nav-privacy .settings-icon { color: #007aff; } /* Blue */
#nav-passcode .settings-icon { color: #ffcc00; } /* Yellow */
#nav-reminders .settings-icon { color: #ff3b30; } /* Red */
#nav-help .settings-icon { color: #007aff; } /* Blue */

/* =========================================== */
/* === Экран "Графики и отчеты" ============ */
/* =========================================== */
#screen-charts-reports { padding-top: var(--header-height); }
#screen-charts-reports .screen-header { position: fixed; width: 100%; top: 0; z-index: 20; background-color: var(--tg-theme-secondary-bg-color);}
.charts-list { margin-top: 16px; }
.settings-item .chart-icon { width: 28px; height: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-right: 16px; }
/* Add specific background/icon for each chart type */
.icon-cycle { background-color: #eaf5ff; color: #5ac8fa; /* Add SVG/Icon */}
.icon-period { background-color: #ffeaef; color: #ff8fa3; /* Add SVG/Icon */}
.icon-patterns { background-color: #fff9e6; color: #ff9f0a; /* Add SVG/Icon */}
.icon-symptoms { background-color: #f4eaff; color: #bf5af2; /* Add SVG/Icon */}

.doctor-report-btn {
    display: flex; align-items: center; justify-content: center; gap: 8px;
    width: calc(100% - 32px); margin: 24px 16px 0; padding: 14px; font-size: 17px; font-weight: 600;
    border-radius: var(--card-border-radius); border: none; cursor: pointer;
    background-color: var(--flo-grey-background); color: var(--tg-theme-link-color);
}
.doctor-report-btn svg { width: 20px; height: 20px; }

/* =========================================== */
/* === Экран "График: Длина цикла" ========= */
/* =========================================== */
#screen-chart-cycle-length-detail { padding-top: var(--header-height); }
#screen-chart-cycle-length-detail .screen-header { position: fixed; width: 100%; top: 0; z-index: 20; background-color: var(--tg-theme-secondary-bg-color);}
.chart-summary-info { padding: 16px; font-size: 13px; color: var(--flo-grey-text-secondary); text-align: center; }
.chart-summary-info .avg-cycle-length { font-weight: 600; color: var(--flo-grey-text-primary); }

.cycle-length-history-chart { display: flex; padding: 0 16px; }
.chart-axis-label {
    writing-mode: vertical-rl; text-orientation: mixed; transform: rotate(180deg);
    font-size: 11px; font-weight: 500; color: var(--flo-green-check);
    padding-right: 8px; margin-right: 8px; border-right: 1px solid var(--flo-green-check);
    text-align: center; flex-shrink: 0; white-space: nowrap;
}
.chart-content { flex-grow: 1; padding-bottom: 10px; }
.cycle-bar-item { margin-bottom: 16px; }
.cycle-bar-item:last-child { margin-bottom: 0; }
.cycle-dates { display: block; font-size: 13px; color: var(--flo-grey-text-secondary); margin-bottom: 4px; }
.bar-container { display: flex; align-items: center; gap: 8px; }
.bar { height: 10px; border-radius: 5px; background-color: var(--flo-pink-primary); /* Default/current */ }
.bar.normal { background-color: #d1d1d6; } /* Grey for normal range */
.bar.long, .bar.very-long { background-color: #ffcc00; } /* Yellow/Orange for irregular */
.bar-label { font-size: 13px; font-weight: 500; color: var(--flo-grey-text-primary); white-space: nowrap; }

/* =========================================== */
/* === Экран "Отчет для врача" ============= */
/* =========================================== */
#screen-doctor-report-view { padding-top: var(--header-height); background-color: var(--flo-grey-text-secondary); } /* Darker bg behind report */
#screen-doctor-report-view .screen-header { position: fixed; width: 100%; top: 0; z-index: 20; background-color: var(--tg-theme-secondary-bg-color);}
.report-content { padding: 10px; }
.report-content img { display: block; max-width: 100%; height: auto; margin: 0 auto 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }

/* =========================================== */
/* === Нижняя навигация ====================== */
/* =========================================== */
.bottom-nav {
    display: flex; justify-content: space-around; align-items: flex-start; /* Align icons to top */
    padding-top: 6px; padding-bottom: calc(4px + env(safe-area-inset-bottom));
    border-top: 0.5px solid var(--flo-grey-border);
    background-color: rgba(249, 249, 249, 0.94); /* Translucent iOS style */
    -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
    position: fixed; bottom: 0; left: 0; width: 100%; z-index: 100;
    min-height: var(--bottom-nav-height);
}

.nav-btn {
    background: none; border: none; color: var(--flo-grey-text-tertiary);
    display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
    padding: 0 5px; cursor: pointer; font-size: 10px; flex-grow: 1; text-align: center; line-height: 1.2; flex-basis: 0;
}
.nav-btn.active { color: var(--flo-pink-primary); }
.nav-icon { margin-bottom: 2px; height: 28px; display: flex; align-items: center; justify-content: center; }
.nav-icon svg { width: 24px; height: 24px; stroke-width: 1.5; }
.nav-label { display: block; }

/* Central Add Button */
.add-log-center-btn { position: relative; top: -18px; /* Pull button up */ }
.add-log-center-btn .nav-icon {
    background-color: var(--flo-pink-primary); color: white;
    border-radius: 50%; width: 56px; height: 56px; margin-bottom: 4px;
    box-shadow: 0 4px 8px rgba(255, 59, 48, 0.3);
}
.add-log-center-btn .nav-icon svg { width: 28px; height: 28px; stroke-width: 2; }
.add-log-center-btn .nav-label { display: none; /* Hide label */ }
.add-log-center-btn.active { color: var(--flo-pink-primary); } /* Keep icon pink */

/* =========================================== */
/* === Placeholders & Helpers ================ */
/* =========================================== */
img[src^="placeholder_"] { display: block; width: 100%; height: 150px; /* Default height */ border: 1px dashed var(--flo-grey-dot); background-color: var(--flo-grey-background); color: var(--flo-grey-text-tertiary); text-align: center; font-size: 12px; display: flex; align-items: center; justify-content: center; }

/* Utility to hide element visually but keep accessible */
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0; }